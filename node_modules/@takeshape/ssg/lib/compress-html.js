"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = compressHtml;

var _minimize = _interopRequireDefault(require("minimize"));

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

const defaultOptions = {
  loose: true
};

function compressHtml(config) {
  return renderTemplate => {
    config.options = { ...defaultOptions,
      ...config.options
    };
    const minimize = new _minimize.default(config.options);
    return async (path, template, context) => {
      const item = await renderTemplate(path, template, context);

      if (item.path.endsWith('.html')) {
        return {
          path: item.path,
          contents: minimize.parse(item.contents)
        };
      }

      return item;
    };
  };
}