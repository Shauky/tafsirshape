"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = createRouteFilter;

var _get = _interopRequireDefault(require("lodash/get"));

var _paths = require("../paths");

var _routing = require("@takeshape/routing");

var _stats = require("../stats");

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function createRouteFilter(config, stats) {
  return function (obj, routeName) {
    const route = (0, _get.default)(config.routes, routeName);
    let path;

    if (route && route.path) {
      const pathResult = (0, _routing.formatPath)(route.path, obj);
      path = (0, _paths.joinPath)(config.pathPrefix, pathResult.path);

      if (pathResult.warnings.length) {
        const currentPath = this.lookup('currentPath');
        pathResult.warnings.forEach(variable => {
          (0, _stats.generateWarning)(stats, 'route-filter', `${currentPath} - failed to create '${routeName}' page - :${variable} resolves to undefined`);
        });
      }
    } else {
      path = '#';
    }

    return path;
  };
}