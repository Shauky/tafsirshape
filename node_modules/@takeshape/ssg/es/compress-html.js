import Minimize from 'minimize';
const defaultOptions = {
  loose: true
};
export default function compressHtml(config) {
  return renderTemplate => {
    config.options = { ...defaultOptions,
      ...config.options
    };
    const minimize = new Minimize(config.options);
    return async (path, template, context) => {
      const item = await renderTemplate(path, template, context);

      if (item.path.endsWith('.html')) {
        return {
          path: item.path,
          contents: minimize.parse(item.contents)
        };
      }

      return item;
    };
  };
}