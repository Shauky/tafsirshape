"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var _util = require("@takeshape/util");

const SPINTERVAL = 100;

async function spin(spinQuery) {
  const res = await spinQuery();
  const status = res === null ? 'running' : res.status;

  switch (status) {
    case 'running':
      await (0, _util.delay)(SPINTERVAL);
      await spin(spinQuery);
      break;

    case 'completed':
      break;

    case 'timeout':
      throw new Error('Export timed out');

    case 'error':
      if (res !== null && res.message) {
        throw new Error(res.message);
      } else {
        throw new Error('An unknown error occurred');
      }

    default:
      throw new Error(`Unexpected export status: ${status}`);
  }
}

var _default = spin;
exports.default = _default;